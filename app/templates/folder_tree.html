{% extends "base.html" %}
{% block content %}

<h2 class="text-2xl font-bold mb-4">Sơ đồ hệ thống (Tree View)</h2>

<div id="tree-container" class="p-4 border rounded bg-white shadow" style="width: 450px;">
    <ul id="tree-root" class="tree"></ul>
</div>

<!-- ================= MODAL TẠO THƯ MỤC (CHỈ 1 BẢN DUY NHẤT) ================= -->
<div id="createFolderModal" class="modal-bg hidden">
    <div class="modal-box">
        <h3 class="modal-title">Tạo thư mục mới</h3>

        <label class="modal-label">Tên thư mục:</label>
        <input id="newFolderName" type="text" class="modal-input">

        <label class="modal-label">Mô tả:</label>
        <textarea id="newFolderDesc" class="modal-textarea"></textarea>

        <input id="create_parent_id" type="hidden">
        <input id="create_level" type="hidden">

        <div class="modal-actions">
            <button id="btnCreateFolder" class="modal-btn modal-btn-primary">Tạo mới</button>
            <button id="btnCancelCreate" class="modal-btn">Hủy</button>
        </div>
    </div>
</div>
<!-- ===================================================== -->

<script src="{{ url_for('static', filename='js/folder_tree.js') }}"></script>

<style>
    .hidden {
        display: none !important;
    }

    /* ==== TREE CONTAINER ==== */
    #tree-container {
        font-family: "Segoe UI", Roboto, sans-serif;
        font-size: 14px;
        line-height: 1.4;
    }

    ul.tree, ul.tree ul {
        list-style: none;
        padding-left: 18px;
        margin: 0;
        border-left: 1px dashed #ccc; /* line dọc giống VSCode */
    }

    /* ==== NODE ==== */
    .tree-node {
        cursor: pointer;
        padding: 4px 0;
        user-select: none;
        display: flex;
        align-items: center;
        gap: 6px;
        color: #333;
        transition: color 0.2s;
    }

    .tree-node:hover {
        color: #007bff;
    }

    /* ==== ARROW / CARET ==== */
    .caret::before {
        content: "▸";              /* icon mũi tên */
        display: inline-block;
        margin-right: 6px;
        font-size: 20px;           /* tăng kích thước */
        line-height: 20px;
        transition: transform .18s ease;
        color: #222;
    }

    .caret-down::before {
        transform: rotate(90deg);
    }

    .nested {
        display: none;
    }

    .active {
        display: block;
    }

    /* ==== BUTTON: ADD / DELETE ==== */
    .add-btn, .delete-btn {
        margin-left: 4px;
        padding: 2px 6px;
        font-size: 11px;
        border-radius: 4px;
        border: none;
        cursor: pointer;
        transition: background 0.15s, transform 0.1s;
    }

    .add-btn {
        background: #e0f2ff;
        color: #0077cc;
    }
    .add-btn:hover {
        background: #bfe7ff;
    }

    .delete-btn {
        background: #ffe0e0;
        color: #d40000;
    }
    .delete-btn:hover {
        background: #ffbfbf;
    }

    /* hiệu ứng click */
    .add-btn:active,
    .delete-btn:active {
        transform: scale(0.92);
    }

    /* ==== MODAL ==== */
    .modal-bg {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.45);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
    }

    .modal-box {
        background: white;
        padding: 22px;
        width: 360px;
        border-radius: 8px;
        box-shadow: 0 6px 18px rgba(0,0,0,0.2);
        animation: fadeIn 0.2s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: scale(0.96); }
        to { opacity: 1; transform: scale(1); }
    }

    .modal-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 12px;
        color: #222;
    }

    .modal-label { display: block; margin-top: 10px; font-weight: 600; }
    .modal-input, .modal-textarea {
        width: 100%;
        margin-top: 4px;
        padding: 7px;
        border: 1px solid #cfd4da;
        border-radius: 5px;
        font-size: 14px;
    }
    .modal-textarea { height: 70px; }

    .modal-actions {
        margin-top: 14px;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
    }

    .modal-btn {
        padding: 7px 14px;
        border: 1px solid #ccc;
        background: #f3f3f3;
        border-radius: 4px;
        cursor: pointer;
        transition: background 0.15s;
    }
    .modal-btn:hover { background: #e2e2e2; }

    .modal-btn-primary {
        background: #007bff;
        color: white;
        border-color: #007bff;
    }
    .modal-btn-primary:hover {
        background: #0069d9;
    }
</style>


{% endblock %}
